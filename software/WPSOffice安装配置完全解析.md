# WPS Office 安装配置完全解析
Linux 下主流发行版选择的一般都是 LibreOffice，这个办公套件历史非常悠久了，作为一个开源项目发展地也相当不错。可是就目前来看，还是有一些地方不尽如人意。WPS 是老牌国产软件，就是在 Windows 平台也能跟 Microsoft Office 中分得一杯羹。几年前它推出了 Linux 版，给我们带来了新的选择。有人可能觉得它是闭源软件，不愿意装。其实作为商业公司，程序员辛辛苦苦写出来的程序已经免费给我们用了，就不能要求人家开源了。开发L inux 版已经是对社区的支持了。我们可以喜欢开源软件，但是思想没有必要那么极端。这个 WPS 可以尝试一下。

下面进入正题。以下教程均在 Ubuntu 16.04 LTS 上测试通过，其他的版本欢迎大家测试。

## 下载安装
WPS for Linux 有三个可靠的下载网站。第一个是我们一般去的，就是 WPS 中文社区了。目前最新版本是 10.1.0.5672。第二个是 WPS 的英文版社区，为什么分开说，因为很神奇的是，它的版本是 10.1.0.5707，稍微更新一点。第三个是 ubuntukylin 的商店，WPS的版本号是10.1.0.6115。我选择的是第三个版本，但其实这个差异并不大，随意哪个都可以的。


下载下来一个deb文件，就可以通过<code>sudo dpkg -i XX.deb</code>命令安装了。安装过程中可能会有依赖问题，<code>sudo apt-get -f install</code>命令即可。

## 安装符号字体
因为版权原因，符号字体没有集成到官方的安装包中，第一次打开会提示缺少字体。但是我们可以很容易地找到这些符号字体，下载一个名为 wps_symbol_fonts.zip 的文件。

新建一个文件夹/usr/share/fonts/wps-office，把文件复制到这个目录然后解压缩就可以了。再次启动 WPS，就不会提示找不到字体文件了。

## 安装中文字体
这时候基本可以正常使用了，大部分教程也就到此为止了。然而在用的过程中你会发现，中文的宋体、楷体是不能显示的。这也很容易理解，这些字体是有版权的，Linux 中没有自带这些字体，因此就不能显示了。然而宋体实在是太重要了，没有是很不方便的。
有一个好消息是，我偶然间发现，我们 WPS 用户可以合法地获取这些字体。版权声明如下：


本软件包括：The FreeType Project，根据其 The FreeType License 的授权条款;获得免费授权;哈工大信息检索研究中心提供中文分词拼音标注和中文简繁转换技术；Hunspell 拼写检查库，Hunspell 源代码为适用 MPL1.1/GPL 2.0/LGPL 2.1 开源许可协议的开源代码；方正字体根据方正官方授权用于WPS Office Linux版使用。


那为什么我们 WPS 中没有预装这些字体呢?原来最初的版本是自带的，后来的版本也许是为了缩小安装包的体积，把字体单独打包了。就是我们的 `wps-office-fonts_1.0_all.deb` 文件了。这个文件中文社区已经失效了，不过好在亲测英文社区可以下载，有需要的小伙伴自行寻找。

## 安装英文字体
这时候中文字体基本上和 Windows 没有差别了。然而我发现有的中英文混合的地方比较难看，原来 WPS 仍然缺少英文字体。其实这已经不是那么重要了，毕竟英文字体在我眼中都差不多。但是为了更好的兼容 WIndows 平台，我们还可以安装这些缺少的字体。

好消息是这些字体也是可以合法获取的，而且对于 Ubuntu 用户来说特别方便。只需要安装官方源中的一个包 `ttf-mscorefonts-installer` 即可。这个包会自动从 SourceForge 网站上下载这些字体，然后安装。不过最近（2018-3-4）这个网站服务器似乎有些问题，不能顺利完成下载。我是从别的网站下载了这些字体，然后用 `dpkg-reconfigure` 命令在本地安装了这些字体。现在可能已经恢复，不然的话自己下载稍微有一点点麻烦。

## 最后
经过这一番折腾，WPS 在 Linux 下的体验已经接近 Windows 了。作为平台福利，这个版本目前没有广告。因此，大家可以多多支持一下 WPS for Linux 项目，他们也很不容易。最后祝大家使用愉快！
